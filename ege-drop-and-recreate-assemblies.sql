/* This script should be executed on EGE target server for your silo.
DO NOT execute in your silo because it wont work. EGE target DB is on Target server, your silo is a initiator from where emails are queued not a traget.
If you follow wiki, you will know how to find target server*/

USE [EGE_TARGET] --Replace db name with designated target for your silo ex, EGE_TARGET_ap_403 for silo 403
GO

---Drop procedure

DROP PROCEDURE [dbo].[up_ege_ProcessEmailBatchTargetQueue]
GO

---Dropping assemblies

DROP ASSEMBLY [Cvent.Ege.Distributor.Clr]
GO
DROP ASSEMBLY [System.ServiceModel]
DROP ASSEMBLY [System.Messaging]
DROP ASSEMBLY [System.Web]
DROP ASSEMBLY [SMDiagnostics]

--Recreate assemblies

CREATE ASSEMBLY [SMDiagnostics]
AUTHORIZATION [dbo]
from 'C:\Windows\Microsoft.NET\Framework\v3.0\Windows Communication Foundation\SMDiagnostics.dll'
with permission_set = UNSAFE;

CREATE ASSEMBLY [System.Web]
AUTHORIZATION [dbo]
FROM 'C:\Windows\Microsoft.NET\Framework64\v2.0.50727\System.Web.dll'
WITH PERMISSION_SET = UNSAFE;

CREATE ASSEMBLY [System.Messaging]
AUTHORIZATION [dbo]
FROM 'C:\Windows\Microsoft.NET\Framework64\v2.0.50727\System.Messaging.dll'	
WITH PERMISSION_SET = UNSAFE;

CREATE ASSEMBLY [System.ServiceModel]
AUTHORIZATION [dbo]
FROM 'C:\Program Files (x86)\Reference Assemblies\Microsoft\Framework\v3.0\System.ServiceModel.dll' 
WITH PERMISSION_SET = UNSAFE;
GO

CREATE ASSEMBLY [Cvent.Ege.Distributor.Clr]
FROM 0x4D5A90000300000004000000FFFF0000B800000000000000400000000000000000000000000000000000000000000000000000000000000000000000800000000E1FBA0E00B409CD21B8014CCD21546869732070726F6772616D2063616E6E6F742062652072756E20696E20444F53206D6F64652E0D0D0A2400000000000000504500004C010300439980540000000000000000E00002210B010B000046000000060000000000001E64000000200000008000000000400000200000000200000400000000000000040000000000000000C000000002000000000000030040850000100000100000000010000010000000000000100000000000000000000000C46300005700000000800000D00300000000000000000000000000000000000000A000000C0000001C6300001C0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000080000000000000000000000082000004800000000000000000000002E7465787400000024440000002000000046000000020000000000000000000000000000200000602E72737263000000D0030000008000000004000000480000000000000000000000000000400000402E72656C6F6300000C00000000A0000000020000004C0000000000000000000000000000400000420000000000000000000000000000000000640000000000004800000002000500982B00008437000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001E027B0A0000042A2202037D0A0000042A1E027B0B0000042A2202037D0B0000042A1E027B0C0000042A2202037D0C0000042A1E027B0D0000042A2202037D0D0000042A1E027B0E0000042A2202037D0E0000042A1E027B0F0000042A2202037D0F0000042A1E027B100000042A2202037D100000042A1E02281500000A2A1E02281500000A2AB202281500000A02037D1100000402047D1200000402057D13000004020E047D14000004020E057D150000042A1E02281500000A2A1E02281500000A2A9202281500000A02037D1600000402047D1700000402057D18000004020E047D190000042A1E02281500000A2A3A02281500000A02037D1A0000042A1E02281B00000A2A220203281C00000A2A26020304281D00000A2A26020304281E00000A2A26020304281F00000A2A3602282000000A036F100000062A3602282000000A036F110000062A1E02281500000A2AD202281500000A02037D1B00000402047D1C00000402057D1D000004020E047D1E000004020E057D1F000004020E067D200000042A1E02281500000A2A3A02281500000A02037D210000042A1E02282100000A2A220203282200000A2A26020304282300000A2A26020304282400000A2A26020304282500000A2A3602282600000A036F200000062A13300500DB0000000100001102282C00000603282700000A0205282800000A2D03052B0572010000707D22000004020E05282800000A2D040E052B0572430000707D2300000402047D24000004020E047D25000004020E067D26000004020E07282800000A2D040E072B0572730000707D27000004020E087D280000040223000000000000F03F282900000A282A00000A0272B90000701B8D020000010A0616282B00000A6F2C00000AA20617282D00000A6F2C00000AA20618282E00000AA20619282F00000AA2061A283000000A6F3100000A8C37000001A206283200000A1628300000062A4E283300000A2C06728C0100702A7E3400000A2A001B300900CB01000002000011140A140B72BC010070733600000A0B076F3700000A7E3400000A0C7E3400000A0D1713041713051713067E3400000A13071713081F0A1309076F3800000A130A110A1A6F3900000A110A72EE0100706F3A00000A110A6F3B00000A130B110B6F3C00000A39AE000000110B6F3D00000A26110B110B72360200706F3E00000A6F3F00000A0C110B110B72540200706F3E00000A6F3F00000A0D110B110B726E0200706F3E00000A6F4000000A1304110B110B72940200706F3E00000A6F4000000A1305110B110B72B60200706F3E00000A6F4100000A1306110B110B72E00200706F3E00000A6F3F00000A1307110B110B72F80200706F3E00000A6F4200000A1308110B110B720C0300706F3E00000A6F4200000A1309DE0C110B2C07110B6F4300000ADCDE0C110A2C07110A6F4300000ADC07110408110509110611071109732B0000060A0611086F4400000A061707146F4500000ADE65130C110C6F4600000A2C0C110C6F4600000A6F4700000A062C1F0675100000027224030070110C6F4800000A284900000A186F300000062B02FE1ADE28130D062C1F067510000002728A030070110D6F4800000A284900000A186F300000062B02FE1ADE00DE0A072C06076F4A00000ADC2A00417C0000020000005D000000BC000000190100000C000000000000000200000040000000E7000000270100000C00000000000000000000000400000055010000590100003D000000400000010000000004000000550100009601000028000000420000010200000004000000BC010000C00100000A00000000000000133006007F00000003000011734B00000A0A0672F20300706F4C00000A06720E0400701A8D020000010B0716178C37000001A20717198C37000001A20718724F050070734D00000A8C0D000001A20719168C37000001A207283200000A6F4E00000A0672990500706F4F00000A0672C50500706F5000000A0602285100000A735200000A6F5300000A062A00133002001C00000004000011282B00000A0A066F5400000A0B02146F5500000A26076F5600000A2A1B3005008300000005000011027B250000042C0B042D09027B240000042D012A7E2A000004250B285700000A027B2300000417735800000A0A061F2D1F14735900000A6F5A00000A0672EF050070285B00000A8C48000001282F00000A285C00000A6F5D00000A6F5E00000A06036F5A00000A066F5F00000ADE0A062C06066F4300000ADCDE0707286000000ADC2A00011C000002002D00426F000A00000000020020005B7B0007000000001B3006000002000006000011736200000A13061106036F6300000A6F6400000A110672230600706F6500000A6F6600000A286700000A0A110672350600706F6500000A6F6600000A286700000A0BD002000002286800000A110672490600706F6500000A6F6600000A286900000AA5020000020C110672650600706F6500000A6F6600000A734D00000A0D110672870600706F6500000A6F6600000A286700000A13041106729B0600706F6500000A6F6600000A286700000A286A00000A1305DE5513070272C106007011076F4800000A036F6B00000A6F6C00000A130B120BFE160D000
WITH PERMISSION_SET = UNSAFE

GO

ALTER ASSEMBLY [Cvent.Ege.Distributor.Clr]
ADD FILE FROM 0xEFBBBF7573696E672053797374656D3B0D0A7573696E672053797374656D2E494F3B0D0A7573696E672053797374656D2E586D6C3B0D0A7573696E672053797374656D2E546578743B0D0A7573696E672053797374656D2E446174613B0D0A7573696E672053797374656D2E446174612E53716C436C69656E743B0D0A7573696E672053797374656D2E436F6C6C656374696F6E732E47656E657269633B0D0A7573696E67204D6963726F736F66742E53616D706C65732E53716C5365727665723B0D0A0D0A6E616D657370616365204376656E742E4567652E4469737472696275746F722E436C720D0A7B0D0A202020202F2F2F203C73756D6D6172793E0D0A202020202F2F2F205468697320636C61737320696D706C656D656E74732074686520546172676574536572766963652E0D0A202020202F2F2F203C2F73756D6D6172793E0D0A202020207075626C696320636C6173732054617267657453657276696365203A20536572766963650D0A202020207B0D0A20202020202020207072697661746520726561646F6E6C7920737472696E67206D5F4D6573736167654F7574707574506174683B0D0A20202020202020207072697661746520726561646F6E6C7920737472696E67206D5F4572726F724F7574707574506174683B0D0A20202020202020207072697661746520726561646F6E6C7920626F6F6C206D5F49734D6573736167654C6F674163746976653B0D0A20202020202020207072697661746520726561646F6E6C7920626F6F6C206D5F49734572726F724C6F674163746976653B0D0A20202020202020207072697661746520726561646F6E6C7920696E74206D5F5365727669636542696E64696E675479706549643B0D0A20202020202020207072697661746520726561646F6E6C7920737472696E67206D5F53657276696365506174683B0D0A09097072697661746520726561646F6E6C7920696E74206D5F53656E6454696D656F75743B0D0A0D0A20202020202020207072697661746520737461746963206F626A656374206D5F4D6573736167654C6F674C6F636B203D20303B0D0A20202020202020207072697661746520737461746963206F626A656374206D5F4572726F724C6F674C6F636B203D20303B0D0A0D0A20202020202020207072697661746520656E756D204572726F724F75747075744C6576656C0D0A20202020202020207B0D0A2020202020202020202020204572726F724F7574707574496E666F2C0D0A2020202020202020202020204572726F724F75747075745761726E696E672C0D0A2020202020202020202020204572726F724F75747075744572726F720D0A20202020202020207D0D0A0D0A20202020202020202F2F2F203C73756D6D6172793E0D0A20202020202020202F2F2F20436F6E7374727563746F720D0A20202020202020202F2F2F203C2F73756D6D6172793E0D0A20202020202020207075626C696320546172676574536572766963652853716C436F6E6E656374696F6E20436F6E6E656374696F6E2C20626F6F6C2069734D6573736167654C6F674163746976652C20737472696E67206D6573736167654F7574707574506174682C20626F6F6C2069734572726F724C6F674163746976652C20737472696E67206572726F724F7574707574506174682C20696E74207365727669636542696E64696E675479706549642C20737472696E672073657276696365506174682C20696E742073656E6454696D656F7574290D0A2020202020202020202020203A206261736528536572766963654E616D652C20436F6E6E656374696F6E290D0A20202020202020207B0D0A2020202020202020202020206D5F4D6573736167654F757470757450617468203D20537472696E672E49734E756C6C4F72456D707479286D6573736167654F75747075745061746829203F204022433A5C53716C436C724C6F675C4D657373616765547261636B696E672E6C6F6722203A206D6573736167654F7574707574506174683B0D0A2020202020202020202020206D5F4572726F724F757470757450617468203D20537472696E672E49734E756C6C4F72456D707479286572726F724F75747075745061746829203F204022433A5C53716C436C724C6F675C4F75747075742E6C6F6722203A206572726F724F7574707574506174683B0D0A2020202020202020202020206D5F49734D6573736167654C6F67416374697665203D2069734D6573736167654C6F674163746976653B0D0A2020202020202020202020206D5F49734572726F724C6F67416374697665203D2069734572726F724C6F674163746976653B0D0A2020202020202020202020206D5F5365727669636542696E64696E67547970654964203D207365727669636542696E64696E675479706549643B0D0A2020202020202020202020206D5F5365727669636550617468203D20537472696E672E49734E756C6C4F72456D70747928736572766963655061746829203F2040222F2F6C6F63616C686F73742F456D61696C2F456D61696C536572766963652E73766322203A2073657276696365506174683B0D0A0909096D5F53656E6454696D656F7574203D2073656E6454696D656F75743B0D0A0D0A20202020202020202020202057616974666F7254696D656F7574203D2054696D655370616E2E46726F6D5365636F6E64732831293B0D0A0D0A20202020202020202020202057726974654572726F724D65737361676528537472696E672E466F726D6174282241637469766174696F6E50726F636573736F72206669726564206F6E205468726561644964207B347D7B337D53716C436F6E746578743A207B307D7B337D57696E646F77734964656E746974793A207B317D7B337D456E7669726F6E6D656E743A207B327D7B337D222C0D0A202020202020202020202020202020204D6963726F736F66742E53716C5365727665722E5365727665722E53716C436F6E746578742E57696E646F77734964656E746974792E4E616D652C0D0A2020202020202020202020202020202053797374656D2E53656375726974792E5072696E636970616C2E57696E646F77734964656E746974792E47657443757272656E7428292E4E616D652C0D0A20202020202020202020202020202020456E7669726F6E6D656E742E557365724E616D652C20456E7669726F6E6D656E742E4E65774C696E652C0D0A2020202020202020202020202020202053797374656D2E546872656164696E672E5468726561642E43757272656E745468726561642E4D616E616765645468726561644964292C204572726F724F75747075744C6576656C2E4572726F724F7574707574496E666F293B0D0A20202020202020207D0D0A0D0A20202020202020207075626C69632073746174696320737472696E672053657276696365
AS N'ActivationProcessor.cs'

GO

ALTER ASSEMBLY [Cvent.Ege.Distributor.Clr]
ADD FILE FROM 0x4D6963726F736F667420432F432B2B204D534620372E30300D0A1A44530000000002000001000000430000004801000000000000410000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000847000000000018FCFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF3088FFFFFFFFFFE7FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF0BCA3101380000000010000000100000000000001800FFFF0400000003800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000F862513FC607D311905300C04FA302A1C4454B99E9E6D211903F00C04FA302A10B9D865A1166D311BD2A0000F80849BD60A66E40CF64824CB6F042D48172A799100000000000000024C5A5858EA32E0AB05FCF3BDADCB6278C0400004C0600002C000000D00900003C000000030000000600000035000000360000003700000038000000390000003A000000070000000C0000000D0000000E00000008000000090000000A0000000B0000000F000000100000001100000012000000130000001400000015000000160000001700000018000000190000001A0000001B0000001C0000001D0000001E0000001F000000200000002100000022000000230000002400000025000000260000002700000028000000290000002A0000002B0000002C0000002D0000002E000000300000002F00000031000000320000003300000034000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
AS N'bin\Release\Cvent.Ege.Distributor.Clr.pdb'

GO

ALTER ASSEMBLY [Cvent.Ege.Distributor.Clr]
ADD FILE FROM 0xEFBBBF2F2F2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D0D0A2F2F203C6175746F2D67656E6572617465643E0D0A2F2F20202020205468697320636F6465207761732067656E657261746564206279206120746F6F6C2E0D0A2F2F202020202052756E74696D652056657273696F6E3A342E302E33303331392E3236310D0A2F2F0D0A2F2F20202020204368616E67657320746F20746869732066696C65206D617920636175736520696E636F7272656374206265686176696F7220616E642077696C6C206265206C6F73742069660D0A2F2F202020202074686520636F646520697320726567656E6572617465642E0D0A2F2F203C2F6175746F2D67656E6572617465643E0D0A2F2F2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D0D0A0D0A6E616D657370616365204376656E742E456D61696C0D0A7B0D0A202020207573696E672053797374656D2E52756E74696D652E53657269616C697A6174696F6E3B0D0A202020200D0A202020200D0A202020205B53797374656D2E436F6465446F6D2E436F6D70696C65722E47656E657261746564436F6465417474726962757465282253797374656D2E52756E74696D652E53657269616C697A6174696F6E222C2022342E302E302E3022295D0D0A202020205B53797374656D2E52756E74696D652E53657269616C697A6174696F6E2E44617461436F6E7472616374417474726962757465284E616D653D224368616E6E656C54797065222C204E616D6573706163653D22687474703A2F2F736368656D61732E64617461636F6E74726163742E6F72672F323030342F30372F4376656E742E456D61696C22295D0D0A202020207075626C696320656E756D204368616E6E656C54797065203A20696E740D0A202020207B0D0A20202020202020200D0A20202020202020205B53797374656D2E52756E74696D652E53657269616C697A6174696F6E2E456E756D4D656D62657241747472696275746528295D0D0A20202020202020204576656E74203D20302C0D0A20202020202020200D0A20202020202020205B53797374656D2E52756E74696D652E53657269616C697A6174696F6E2E456E756D4D656D62657241747472696275746528295D0D0A2020202020202020454D61726B6574696E67203D20312C0D0A20202020202020200D0A20202020202020205B53797374656D2E52756E74696D652E53657269616C697A6174696F6E2E456E756D4D656D62657241747472696275746528295D0D0A20202020202020204D656D62657273686970203D20322C0D0A20202020202020200D0A20202020202020205B53797374656D2E52756E74696D652E53657269616C697A6174696F6E2E456E756D4D656D62657241747472696275746528295D0D0A2020202020202020537572766579203D20332C0D0A20202020202020200D0A20202020202020205B53797374656D2E52756E74696D652E53657269616C697A6174696F6E2E456E756D4D656D62657241747472696275746528295D0D0A20202020202020204F7074496E203D20342C0D0A20202020202020200D0A20202020202020205B53797374656D2E52756E74696D652E53657269616C697A6174696F6E2E456E756D4D656D62657241747472696275746528295D0D0A202020202020202045787072657373203D20352C0D0A0D0A20202020202020205B53797374656D2E52756E74696D652E53657269616C697A6174696F6E2E456E756D4D656D62657241747472696275746528295D0D0A20202020202020204775657374203D20362C0D0A0D0A20202020202020205B53797374656D2E52756E74696D652E53657269616C697A6174696F6E2E456E756D4D656D62657241747472696275746528295D0D0A2020202020202020506F7274616C203D20372C0D0A202020207D0D0A7D0D0A6E616D657370616365204376656E742E456D61696C2E486F73740D0A7B0D0A202020207573696E672053797374656D2E52756E74696D652E53657269616C697A6174696F6E3B0D0A202020207573696E672053797374656D3B0D0A202020200D0A202020200D0A202020205B53797374656D2E446961676E6F73746963732E4465627567676572537465705468726F75676841747472696275746528295D0D0A202020205B53797374656D2E436F6465446F6D2E436F6D70696C65722E47656E657261746564436F6465417474726962757465282253797374656D2E52756E74696D652E53657269616C697A6174696F6E222C2022342E302E302E3022295D0D0A202020205B53797374656D2E52756E74696D652E53657269616C697A6174696F6E2E44617461436F6E7472616374417474726962757465284E616D653D224163746976697479456D61696C44746F222C204E616D6573706163653D22687474703A2F2F736368656D61732E64617461636F6E74726163742E6F72672F323030342F30372F4376656E742E456D61696C2E486F737422295D0D0A202020205B53797374656D2E53657269616C697A61626C6541747472696275746528295D0D0A202020207075626C6963207061727469616C20636C617373204163746976697479456D61696C44746F203A206F626A6563742C2053797374656D2E52756E74696D652E53657269616C697A6174696F6E2E49457874656E7369626C65446174614F626A6563740D0A202020207B0D0A20202020202020200D0A20202020202020205B53797374656D2E4E6F6E53657269616C697A656441747472696275746528295D0D0A2020202020202020707269766174652053797374656D2E52756E74696D652E53657269616C697A6174696F6E2E457874656E73696F6E446174614F626A65637420657874656E73696F6E446174614669656C643B0D0A20202020202020200D0A20202020202020205B53797374656D2E52756E74696D652E53657269616C697A6174696F6E2E4F7074696F6E616C4669656C6441747472696275746528295D0D0A2020202020202020707269766174652073686F7274204163746976697479456D61696C466F726D61745479706549644669656C643B0D0A20202020202020200D0A20202020202020205B53797374656D2E52756E74696D652E53657269616C697A6174696F6E2E4F7074696F6E616C4669656C6441747472696275746528295D0D0A20202020202020207072697661746520737472696E6720426F647948746D6C4669656C643B0D0A20202020202020200D0A20202020202020205B53797374656D2E52756E74696D652E536572
AS N'EmailServiceClient.cs'

GO

ALTER ASSEMBLY [Cvent.Ege.Distributor.Clr]
ADD FILE FROM 0xEFBBBF2F2F2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D0D0A2F2F203C6175746F2D67656E6572617465643E0D0A2F2F20202020205468697320636F6465207761732067656E657261746564206279206120746F6F6C2E0D0A2F2F202020202052756E74696D652056657273696F6E3A342E302E33303331392E3233390D0A2F2F0D0A2F2F20202020204368616E67657320746F20746869732066696C65206D617920636175736520696E636F7272656374206265686176696F7220616E642077696C6C206265206C6F73742069660D0A2F2F202020202074686520636F646520697320726567656E6572617465642E0D0A2F2F203C2F6175746F2D67656E6572617465643E0D0A2F2F2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D0D0A0D0A0D0A0D0A5B53797374656D2E436F6465446F6D2E436F6D70696C65722E47656E657261746564436F6465417474726962757465282253797374656D2E536572766963654D6F64656C222C2022342E302E302E3022295D0D0A5B53797374656D2E536572766963654D6F64656C2E53657276696365436F6E747261637441747472696275746528436F6E66696775726174696F6E4E616D653D22494578706F72745365727669636522295D0D0A7075626C696320696E7465726661636520494578706F7274536572766963650D0A7B0D0A202020200D0A202020205B53797374656D2E536572766963654D6F64656C2E4F7065726174696F6E436F6E747261637441747472696275746528416374696F6E3D22687474703A2F2F74656D707572692E6F72672F494578706F7274536572766963652F47657450726573656E746174696F6E4578706F727444617461222C205265706C79416374696F6E3D22687474703A2F2F74656D707572692E6F72672F494578706F7274536572766963652F47657450726573656E746174696F6E4578706F727444617461526573706F6E736522295D0D0A202020204578706F727453657276696365526573706F6E73652047657450726573656E746174696F6E4578706F727444617461284578706F727453657276696365526571756573742072657175657374293B0D0A7D0D0A0D0A5B53797374656D2E446961676E6F73746963732E4465627567676572537465705468726F75676841747472696275746528295D0D0A5B53797374656D2E436F6465446F6D2E436F6D70696C65722E47656E657261746564436F6465417474726962757465282253797374656D2E536572766963654D6F64656C222C2022342E302E302E3022295D0D0A5B53797374656D2E536572766963654D6F64656C2E4D657373616765436F6E747261637441747472696275746528577261707065724E616D653D224578706F72745365727669636552657175657374222C20577261707065724E616D6573706163653D22687474703A2F2F74656D707572692E6F72672F222C204973577261707065643D74727565295D0D0A7075626C6963207061727469616C20636C617373204578706F727453657276696365526571756573740D0A7B0D0A202020200D0A202020205B53797374656D2E536572766963654D6F64656C2E4D657373616765426F64794D656D626572417474726962757465284E616D6573706163653D22687474703A2F2F74656D707572692E6F72672F222C204F726465723D30295D0D0A202020207075626C696320696E7420436F6E63757272656E63794C6576656C3B0D0A202020200D0A202020205B53797374656D2E536572766963654D6F64656C2E4D657373616765426F64794D656D626572417474726962757465284E616D6573706163653D22687474703A2F2F74656D707572692E6F72672F222C204F726465723D31295D0D0A202020207075626C696320737472696E67204964537475623B0D0A202020200D0A202020205B53797374656D2E536572766963654D6F64656C2E4D657373616765426F64794D656D626572417474726962757465284E616D6573706163653D22687474703A2F2F74656D707572692E6F72672F222C204F726465723D32295D0D0A202020207075626C696320696E74204974656D436F756E743B0D0A202020200D0A202020205B53797374656D2E536572766963654D6F64656C2E4D657373616765426F64794D656D626572417474726962757465284E616D6573706163653D22687474703A2F2F74656D707572692E6F72672F222C204F726465723D33295D0D0A202020207075626C696320696E74204F7065726174696F6E4475726174696F6E54696D653B0D0A202020200D0A202020205B53797374656D2E536572766963654D6F64656C2E4D657373616765426F64794D656D626572417474726962757465284E616D6573706163653D22687474703A2F2F74656D707572692E6F72672F222C204F726465723D34295D0D0A202020207075626C696320696E74204F7065726174696F6E4475726174696F6E54696D65566172696174696F6E3B0D0A202020200D0A202020205B53797374656D2E536572766963654D6F64656C2E4D657373616765426F64794D656D626572417474726962757465284E616D6573706163653D22687474703A2F2F74656D707572692E6F72672F222C204F726465723D35295D0D0A202020207075626C696320696E742054696D656F75744672657175656E63793B0D0A202020200D0A202020207075626C6963204578706F7274536572766963655265717565737428290D0A202020207B0D0A202020207D0D0A202020200D0A202020207075626C6963204578706F7274536572766963655265717565737428696E7420436F6E63757272656E63794C6576656C2C20737472696E67204964537475622C20696E74204974656D436F756E742C20696E74204F7065726174696F6E4475726174696F6E54696D652C20696E74204F7065726174696F6E4475726174696F6E54696D65566172696174696F6E2C20696E742054696D656F75744672657175656E6379290D0A202020207B0D0A2020202020202020746869732E436F6E63757272656E63794C6576656C203D20436F6E63757272656E63794C6576656C3B0D0A2020202020202020746869732E496453747562203D204964537475623B0D0A2020202020202020746869732E4974656D436F756E74203D204974656D436F756E743B0D0A2020202020202020746869732E4F7065726174696F6E4475726174696F6E54696D65203D204F7065726174696F6E4475726174696F6E54696D653B0D0A202020202020202074686973
AS N'ExportServiceClient.cs'

GO

ALTER ASSEMBLY [Cvent.Ege.Distributor.Clr]
ADD FILE FROM 0xEFBBBF7573696E672053797374656D2E5265666C656374696F6E3B0D0A7573696E672053797374656D2E52756E74696D652E436F6D70696C657253657276696365733B0D0A7573696E672053797374656D2E52756E74696D652E496E7465726F7053657276696365733B0D0A7573696E672053797374656D2E446174612E53716C3B0D0A0D0A2F2F2047656E6572616C20496E666F726D6174696F6E2061626F757420616E20617373656D626C7920697320636F6E74726F6C6C6564207468726F7567682074686520666F6C6C6F77696E670D0A2F2F20736574206F6620617474726962757465732E204368616E6765207468657365206174747269627574652076616C75657320746F206D6F646966792074686520696E666F726D6174696F6E0D0A2F2F206173736F636961746564207769746820616E20617373656D626C792E0D0A5B617373656D626C793A20417373656D626C795469746C6528224376656E742E4567652E4469737472696275746F722E436C7222295D0D0A5B617373656D626C793A20417373656D626C794465736372697074696F6E282222295D0D0A5B617373656D626C793A20417373656D626C79436F6E66696775726174696F6E282222295D0D0A5B617373656D626C793A20417373656D626C79436F6D70616E7928224D6963726F736F667422295D0D0A5B617373656D626C793A20417373656D626C7950726F6475637428224376656E742E4567652E4469737472696275746F722E436C7222295D0D0A5B617373656D626C793A20417373656D626C79436F707972696768742822436F7079726967687420C2A9204D6963726F736F6674203230313222295D0D0A5B617373656D626C793A20417373656D626C7954726164656D61726B282222295D0D0A5B617373656D626C793A20417373656D626C7943756C74757265282222295D0D0A0D0A5B617373656D626C793A20436F6D56697369626C652866616C7365295D0D0A0D0A2F2F0D0A2F2F2056657273696F6E20696E666F726D6174696F6E20666F7220616E20617373656D626C7920636F6E7369737473206F662074686520666F6C6C6F77696E6720666F75722076616C7565733A0D0A2F2F0D0A2F2F2020202020204D616A6F722056657273696F6E0D0A2F2F2020202020204D696E6F722056657273696F6E0D0A2F2F2020202020204275696C64204E756D6265720D0A2F2F2020202020205265766973696F6E0D0A2F2F0D0A2F2F20596F752063616E207370656369667920616C6C207468652076616C756573206F7220796F752063616E2064656661756C7420746865205265766973696F6E20616E64204275696C64204E756D626572730D0A2F2F206279207573696E672074686520272A272061732073686F776E2062656C6F773A0D0A5B617373656D626C793A20417373656D626C7956657273696F6E2822312E302E302E3022295D0D0A0D0A
AS N'Properties\AssemblyInfo.cs'

GO

EXEC sys.sp_addextendedproperty @name=N'SqlAssemblyProjectRoot', @value=N'C:\CventApp\Dev\Modules\Cvent.Ege.Distributor\Cvent.Ege.Distributor.Clr' , @level0type=N'ASSEMBLY',@level0name=N'Cvent.Ege.Distributor.Clr'
GO

--Recreate procedure

USE [EGE_TARGET]
GO
SET ANSI_NULLS OFF
GO

SET QUOTED_IDENTIFIER OFF
GO

CREATE PROCEDURE [dbo].[up_ege_ProcessEmailBatchTargetQueue]
WITH EXECUTE AS CALLER
AS
EXTERNAL NAME [Cvent.Ege.Distributor.Clr].[Cvent.Ege.Distributor.Clr.TargetService].[up_ege_ProcessEmailBatchTargetQueue]
GO

EXEC sys.sp_addextendedproperty @name=N'SqlAssemblyFile', @value=N'ActivationProcessor.cs' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'PROCEDURE',@level1name=N'up_ege_ProcessEmailBatchTargetQueue'
GO

EXEC sys.sp_addextendedproperty @name=N'SqlAssemblyFileLine', @value=N'46' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'PROCEDURE',@level1name=N'up_ege_ProcessEmailBatchTargetQueue'
GO

